# 工作流式的分章节并行文章生成

流程：技术方案的历程
    1. 大纲生成（gpt真实研报抽取+改写 -> 维度全面、补充特定公司资料（上级领导要求）-> 在正文生成结束润色形成带观点（看多、看空）的大纲标题）
        1. **gpt真实研报抽取+改写**：显然应该学习真实研报，但是真实研报的标题形容词丰富、也是作者基于正文润色的（如：智驾平权落地，品牌势能向上 -> 智能驾驶技术研发情况、大力改革，苦修内功 -> 管理层与股权结构分析），所以是用LLM对真实研报进行改写得到的数据集。
        2. **维度全面、补充特定公司资料**：之前的问题：真实研报集中分析某些利好的方面【如：某个产品成本下降】（因为作者在写作之前已经知道要写什么）。改进：因为LLM不知道要提前研究什么，也没有一定要生成利好的倾向，可以分析利空。我们取公司最近的中年报，全维度分析公司的各个方面，GPT对原数据集改造+人工校对。
        3. **在正文生成结束润色形成带观点**：之前的问题：大纲标题过于直白，没有观点。改建：基于正文对标题进行润色，发现R1的语言风格、专业性高、这种简单任务也没有幻觉问题，用R1做模型蒸馏构建数据集。
        4. **专题报告生成**：之前的问题：用户不想对公司做全维度的分析，只想分析公司的营收、某个业务的发展情况等等专题研究。改进：开始的时候用GPT构建数据集但是效果不好，改成r1之后效果大幅提升，专业性强。
        5. **支持用户指令输入【正在做】**：之前的问题：1. 用户目前只能上传标题 或者 自己的大纲，不能写一段话来进行大纲生成，期望新的交互更智能、更像AI产品。 2. 文字之间的逻辑性不强，各点相互独立。没有一个逻辑串起来行文之间的逻辑（例：智能手机发展）。 改进：1. 合成数据进行训练 2. 在大纲这一步将研究思路一并生成，通过RAG，结合真实研报，生成逻辑性更强的文字，而不是之前分点的写作内容。
        具体的做法：xxxx

    2. 研究思路生成（RAG搜索+embedding -> Agent式串行 -> deep search深度搜索思考（受openai启发，在核对时传入高质量且有效的研究思路））
        1. **RAG搜索+embedding**：用title检索网页、切分、相关性判断、LLM生成关键词作为研究思路。
        2. **Agent式串行**：之前的问题：研究思路的粒度太粗，仅分成了几个宽泛的点，设计了二级的研究思路结构从粗到细，并结合了Agent进行搜素工具的调用
        3. **deep search深度搜索思考**：同上第5条
    
    3. 搜索（公司内部的搜索接口 和 博查、秘塔等有差距），总结与过滤（从网页分段embedding -> LLM总结）
        - 金融指标数据的搜索
            - 什么是金融指标（以时间为序列的数值）
            新能源汽车:产量:当月值、GDP:全国
        
            - 为什么用金融指标
            核心是画图，然后可以让正文素材来源引用规范、真实，体现公司数据丰富
        
            - 如何检索出适合的金融指标
            （embedding（没有联想能力、embedding效果相关性也不佳） -> LLM（按行业构建指标库【人工+LLM】、利用真实研报的图文信息【失败】） -> 正文写完反向找指标增强【利用R1推理能力，生成聚合指标图】）

        - 搜索接口即是Agent工具
            - 公司公告
            - 研究报告
            - bing
            - 金融指标
            - 公司数据接口（分产品营收、公司股权结构）
        
        - 总结与过滤
            - 总结 + 补充质量、主题一致性判断（GPT判断得没有很准，例：三星 兴三星）（从网页分段embedding -> LLM总结）

    4. 正文生成
        - GPT蒸馏 -> R1蒸馏（幻觉多+AI校对、人工校对复杂）

    5. 特定章节写作
        - 投资建议（重要章节）
        搜索大概率找不到合适的素材、如：PE、分产品营收、同比公司
        - 风险提示（不重要章节）
        章节短、不必搜索

    